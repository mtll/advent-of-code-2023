(* ::Package:: *)

(* ::Input:: *)
(*SetDirectory[NotebookDirectory[]];*)


(* ::Title:: *)
(*2023 Day 5*)


(* ::Input:: *)
(*intervalComplement[Interval[{a_,b_}]]:=Interval[{-\[Infinity],a-1},{b+1,\[Infinity]}];*)
(*intervalComplement[x:{__Interval}]:=IntervalIntersection@@(intervalComplement/@x);*)
(*makemap[{t_,f_,r_}]:={Interval[{t,t+r}],Interval[{f,f+r}]};*)
(*makerule[{t_,f_}]:=x_Interval:>Min@t+IntervalIntersection[x,f]-Min@f;*)
(*defaultrule[i_]:=x_Interval:>IntervalIntersection[x,i]*)
(*mapseed[s_,m_]:=DeleteCases[Flatten[ReplaceList[#,m]&/@s],Interval[]];*)


(* ::Input:: *)
(*{{seeds},maps}=StringSplit/@StringSplit[ReadString["5.txt"],"\n\n"]//TakeDrop[#,1]&;*)
(*seeds=ToExpression@Rest@seeds;*)
(*maps=BlockMap[makemap,#,3]&/@ToExpression@maps[[All,3;;]];*)
(*rules=MapThread[Dispatch@Append[#1,defaultrule@intervalComplement@#2]&,{Map[makerule,maps,{2}],maps[[All,All,2]]}];*)


(* ::Subsection:: *)
(*Part 1*)


(* ::Input:: *)
(*Min@Fold[mapseed,Interval[{#,#}]&/@seeds,rules]*)


(* ::Subsection:: *)
(*Part 2*)


(* ::Input:: *)
(*Min@Fold[mapseed,BlockMap[Interval[{#[[1]],Total@#}]&,seeds,2],rules]*)


(* ::Subsection:: *)
(*Christmas Tree*)


(* ::Input:: *)
(*pp[Interval[{n1_,n2_}]]:=IntegerString[n1]<>"\n"<>IntegerString[n2]*)


(* ::Input:: *)
(*(Fold[{s,r}|->s/.x_Interval:>t[pp@x,DeleteCases[ReplaceList[x,r],Interval[]]],BlockMap[Interval[{#[[1]],Total@#}]&,seeds,2][[2]],rules]//Append[#,TreeLayout->Top]&)/.{t->Tree,x_Interval:>pp@x}*)


(* ::Input:: *)
(*Overlay[{Graphics[{{FaceForm[{RGBColor[1., 1., 0.], Opacity[1.]}], TagBox[FilledCurveBox[BezierCurve[CompressedData["*)
(*1:eJxTTMoPSmViYGCQB2IQ7cG+3epP+1H7xW7vXzIXfrBH57dtt1Q9X3nAPvbj*)
(*c2dZv7cE+Q4W3PNzj/gSzXdJurz37eZd9gau6iw8Eq8J8vcdujFp8vQN9p4r*)
(*DUoUW54T5MP8Ux76cbPRrpcE+dOvMYSJJ12E6yfEL4htmca47SzcfYT4axqf*)
(*M0tVXoX7nxCfJ9wkQHPaKaL5hOITAHjM5co=*)
(*"]]], "BezierEditable"]}, {AbsoluteThickness[7.641509433962264], StrokeForm[{RGBColor[1., 1., 0.], Opacity[1.]}], EdgeForm[{RGBColor[0., 0., 0.], Opacity[1.]}], EdgeForm[None], Line[CompressedData["*)
(*1:eJyN1Xk01WkYB/A7lBCSSEcmRPZjaXMrPKhJJo4lLVOWJstc2xAVJboqk5LS*)
(*6tomFNpjKKF663bTxXV3W1134W4tmk7dbko5M/3x+91zmn/mj/f8zuef93fO*)
(*8z7P97HZkR6RoEUgEPb/e75937UKTzvEKxGp8MRwzO1+0PFsOOEdoUS0RYx6*)
(*WWY/WNxIOxbup0QLu/QyUz36wc1p2R+JbkpETgz0fT/Oh4D6LwW5lkok0CnU*)
(*33eND5tsaHml+kq0spE6QEjiQ1J18d76CQUiZUu8aYF8OHXOYieLr0CUQMLF*)
(*I/Z8qJ89miqlKlCXuZXe+ul8aC+5QvrUpEAqhU+6kZT3HzP0dsYbXVAgu7tR*)
(*/RwqD8SFxO22JRqrfiBEEXMVKKIod9W5Wh7o5j/dHJKksceeTaHZPykQeUtF*)
(*7RYyD1JeXg+4M0uBmhzbZ1jG8qDjWY+nPl2OhBODaSIfHuj3Kq1jyHJk0K3m*)
(*1VnyIM2LOfOpvRwlJy2tcXrGhXsOrz9biGSIsmKDzvhdLnysDHjzyxUZ+lau*)
(*pjIuLDEul1CyZMju6i2i10YuHCS0sV+7yFDEPuafn5dw4cEuQ5qLWooO/jw+*)
(*7YEJFwwTXFoO3JQi4Utnzho2B2wk726erdI4amNQHS9Riow6g7x0b3HgcMhQ*)
(*+dcAKfIuJlX3lnAAPXIr8TaUouRtR7RPpnKA56MuCp8cwz25rJCcOziGKlwa*)
(*kiLWc2Chm2lOfYvGMXXJKdI8jcvnPoqxXTeG6JM0lpkzB17oiEKyCRoHZ9GI*)
(*4oZRpO4dWzasy4HKuFGHpbGjyL5Kq6pKwQZ7+ib9pxIJiky10drexYajS70/*)
(*uBdJ0EFvP5JtPRsczXJ4gxNi9JdBLFN+iA1dH1qaDySJkdGNqoo0fzb0XBdZ*)
(*hbaKkG9eJ8HTmg3C3XTprnYhGqpo7VN+ZYGll18trWIEnX3unqjOYcHWibZo*)
(*0/0CFGx5bUpbxYTz7e4W8dHPcX/JXM4csXiG4r/GxVFcmVBkx9hb0DqEaNW1*)
(*7lYv+8Cb+dYy1HkQCfK3nm1Z2Advs80eWtb0I6IVZftKMQMiPS13nY/mI1Xs*)
(*nE+B2xgwOtpstfIjF4URwp8w5zFgwSUnwdEhDrpec+LUxoFeiEqopQy3s3GL*)
(*o0w7p/JYyMCfES040wsZRlcT68yZiCTRc44L74UJBCZrmxmIVhCofmHUCzkB*)
(*7sWyrB7cNXyCmWc+HdktLKRmMHqAFGiUZ/fpCRLsIGzLD+wBj475MvNdjxFR*)
(*29dh+vQeoHxrqNiHuP0O8S+8zm5HlIu574up3WDs/JurbWgLbkJcipu22xUU*)
(*JlUXl/t0w0Oh51x/dSVqOrx0i/UkHQjCJb5/++/B7ZfmOHXF5AxgfuiQ7UT5*)
(*1AAGizLtGu/SoaYvPtFnbjNutj13WAfacGdc0E53/HgfN+G4hVb9Zirudeta*)
(*GLdbnuAunRZc1jWrG3dOrbXfAUGv5r60yvneZBbueNe045eHOUBPGL/XuoQO*)
(*xIpKrWgWD7dy1qoChbIft3T3xJsnHYO4dflrIpmkYdyui0+1D8x9jnte0mVV*)
(*02wB/r+w0pEFIprGQ40exF89RvD6FLWZBBnmaGzKSthxcmwEsHq/HhhITpgh*)
(*BNXqdmRC7oZgdcXx++eFgL1P0Y/sO6+CRECmUk98PNoDwfadqmxjMWD9QH20*)
(*1kRWIgasv4wTVhMd3SWA9ety4+ZEf5UEsP7+3Utemt44Cta+osn6xj64HDO/*)
(*s3rrGGDzseBzw5D+0BjoRtuXzU5nQkfJo/FaTylcv6fsOdbMhNTqi1Mhe6Xw*)
(*Njdtcd5yFng4hcycdUsK2DyqWtXmbKkUsHnt8KuxO2UhA2y+8xlBnhFhMsDy*)
(*wE3gEjBVJgMsT8SvDDdcFckAy6NL2W2xKWZywPJu/wFHkv8KOWD5GHmkPMM8*)
(*Wg5Ynrqe1N87TpYDlreYsTyeN2d13tBpOaiHS7lZezTG8vv/Gsv/761Tllvw*)
(*+JIcsH2BGdsnmLF9gxnbR5ixffW9/wFksAAd*)
(*"]]}, {AbsoluteThickness[7.641509433962264], StrokeForm[{RGBColor[1., 1., 0.], Opacity[1.]}], EdgeForm[{RGBColor[0., 0., 0.], Opacity[1.]}], EdgeForm[None], Line[CompressedData["*)
(*1:eJx11Hs01FkcAPDxSCetVSRTI4/OFknLWu1ORXeSUKFJkXXarDpSEtOyaOWx*)
(*Ex21clSjOmq2EdFTSskrXzExGo8x5tU0xrzMA1OclVqPdu0f/eYPpz/uuedz*)
(*7j333O/9fr/X6WBiaIwxDoeLnR3/z0//PiwQUnVQFVZg+5BQDR2J33JHKDog*)
(*8a6oL616Av3D77uMonTACS15mub+FEZjn3csDdYBo9B9ZFdTDRwhx1XR5Fpo*)
(*PhfmohysBynR9opVihYcA/TrbmQ+h1uLFfGqFg3gtgQYMQqb4djQfd8aSw2k*)
(*Sa8cG41ugW0ILaHvUAOj8VBCSGUrONB6B0/nDgKn2P3E/UkmWMSsrc6qVEHE*)
(*sg2kC6Zt0Oczkbd7SgkkYvabaXYbHLgZd0yVoQROzdm7cn476MwGglNxSqjl*)
(*c7YF01kQlMQkysoVELH+0sm2ARZcO6Rw9opSAK4o7AFa2QFCIZGQtEYBpL3i*)
(*JZ4VHTC0B2ebZ6sAbfX1wHu6DvjU025Fn2fwRj97M0mPHPKso0594/YK6FUm*)
(*Y34pcuBwlcqlj+Z6l8V8thFfBrVjrlnUNDbYqHsZfU4yIFG8QmKpnZAZbtpq*)
(*5yoFSghu98vuLnDspX6vZr2Bj50LHO+KukGwZOgIP14ENH7c4hwrDuApZc/8*)
(*T/HhNpNjVV3LgexW/Yw8lgujp8N+v+XTC5x1CXmT5d1gmtSQzlP2AlmlWNX/*)
(*kgV2B50yTM5x4errATOKCRMKx5g76vRcqKLX9cyjNsFtmWuQ9lIfkIel2l89*)
(*HsPIjYfVYjwPSGtaJBdopeAR5UXoovMAx/8t8sSPWcBrmgjxl/GgeYiYa04u*)
(*QoEhxXbTW/nQ7Jy65uo/5QifmV5DjOED5Sv9Hb3XY5Rv4ZDzlsUHRkzkimc/*)
(*1yKP4/JnsQsFkPa1ebrf8maEo7fsLnMTAEWcE27U1IrKpnNyVyQKAF8j9427*)
(*046S3Q47RBYKgHVhs3sfjY3w+S57+riz+49fI3hn96B8Qqfj2R+E4O0lpWXO*)
(*9KL9Ox/Uv9wnhJE7GdYLbHkIdy/x7eZiIWgtN/2h0fIx03LF/54wFqEyc8+V*)
(*tRIheHT27fzo9xpz2fLNjL33xJifbFdxI6hvMI9Sls2cWS/BTC7stx9gGiyq*)
(*8CBGe/Rj9m4f/6kO+hFHTM5LbxACUxqQtGmtFHPQRHH+88tS7H5VNlGVNqsH*)
(*kEd6wV7jk7PrqxvGUxfJMLe88LcaPC/D4p3Wpntbb5FjpuTMj8xuMrjJ2TS7*)
(*NUqB2TGAVUJ4Z/DtA4QGeqQSe8/IhBn29ptK1Dg8dCbIRgieKQk8hzYl0jYs*)
(*0FuOC+bYfrJcZC76ss0zByTvdUosfxNGeLlsSokC9wfUXX4kAEUueZBtocLy*)
(*XX/+hb7kOxVWD7Qiz4nUMBXidZYOy4IFEE8v/RR80uAIJ4nxhj9VWD3ZPci1*)
(*nGxWYfU2/mTClqMyuJwpcjnlNoh+8cHZrx3iQzivfoNLssFmqus7eA0Gdyb6*)
(*7ysaM7hw6t2hcGc15iMm0fFuOw0mLeQmGycajLfemiG6qMb64dXKVQU5YoML*)
(*KruLty3SYD5cg0oJXgaHbkyrMPP/st18dQ8lRzWosd9n6FEFH0a7LjbSb2iw*)
(*/mT0J3dt12hQ2Vuhlmo0e/5Re7H5Ci363N+u79vV7FAtauwpDLbdyAPjGeK7*)
(*khQt+vwfiE3vfkgtnms7Sveyvz70QVueYurgfS0KJOmzogVz/R+uJZLg*)
(*"]]}, {AbsoluteThickness[7.641509433962264], StrokeForm[{RGBColor[1., 1., 0.], Opacity[1.]}], EdgeForm[{RGBColor[0., 0., 0.], Opacity[1.]}], EdgeForm[None], Line[CompressedData["*)
(*1:eJx103s0lGkcB/BJYtTMqsZSSrG5taSUUkteHGSVe3IJ2TSISayiSI22jS6k*)
(*i9JFRmySyogykvmNxrjspCa33I25vO9rO9G4Faqznf3jnT86+8dznvP56/ec*)
(*7+/7GOw96ENXIZFIUd/Of7dXNPvKEA5/JF3fQF8ohmzX6WJuLQ5+xcktBZZi*)
(*KKznFbaV4mDydnfkgI8YxioHLpnsw6F504qb/jli2GVQn5o9H4etDXVR1Gkx*)
(*VGeWRE2zMSj3o2/iBw8B+Xijv/t+DHyfmETb5g+Bf6zcpcAAA2rqtJfOmyGQ*)
(*tAautipCobyv5lQ2TQJ629jLE2JR8LU9ztHYJYED1q8WNBqjQFX1ypelS0BU*)
(*WDG1tkUOjUKD01AtgdhTo+1vt8oh7fI448Y7CVDpZhUnHsnAaPwJi2Yhhbat*)
(*Uxnes1IYfJaePrJHCsNqg+5JJCmk6brVRN6RAn93/MpQGwnYSJbdcWyXQh57*)
(*rsIpcQgmS95n6KnJwJOqLpzTIYayeDj4yVoGI+8dS0qcxZBWwNLYGCiDJXlf*)
(*fihkDIL3m7TC+GQZqMX6993OGYAF133P7nggA6e1r3NHEvuhv8nK8EyLDJgf*)
(*XPzsAvqg7NOPXMGIDLjl3EVZW3phPw8rYunL4acYgUD9Yzd4B3Qp7Czl0Kn1*)
(*T1QHowvGq24YcRLkoFJcM6af1AnXdEICLZ/KwXxL5jFGWjt4D1rYU3A5BAhD*)
(*1TjnWmFBMckEW4pCML0gt7taBILYVuqL7Sjwvjb6Tb1ugZzbFcVfGShkxHfU*)
(*DrsJIfLVFQebLBRIE/WbzlCbYcvXw71JZSisO32V167TCAZXI0y1eShwrM0Z*)
(*R8oFoGHhf7hShEJu96Ba3Nx6GBdse+EzhMLC4NcnNBvqoDdks6ZCgUJcnwPt*)
(*KQuAP2kafEEFAxFJbuz+pAYeZi4tWUPDQN8o4xdZcxWk1s44RlthEPermUfK*)
(*QAVE+r27QHbGQHxLi3mo8RFY//lytXMEBqQoN33HiiIw0KtNlCZiwJTvrjmq*)
(*fQp6ZVkh3HsY2IdH65qTbyGlWnEfZ5ox4OlVO+uOliGpTt4Xrd9hwKIH6VWF*)
(*cBDPQ+vNDlFwOPLD/BQnXR6iYau62NMOB/bNz4u9818QFpuO3g8xFHxnRdtE*)
(*6HsPHJoEfF9tRSPSHSMvPbcHh7Dfk6kp84TI5Q1VlyIu4uCq6fl0Q2sLkios*)
(*HlS9g8OHfpXNOxJECD0817zwMQ5atp55Ow1aEevLRxsG277NP+k63BPehqw0*)
(*i6Ydl+HwuWuVC3WkHVHnB4Utn8SBp/PgTC2lk7DIxed5nbQTUQRtf/hs3jBQ*)
(*YtPR0atvCTMyt5NdjbsI36tkrk/sVpojNaYns7sJF+nasXaW9hDeF9ggVf27*)
(*F+kes5kJ0B4GEgvWnqP0E76FclIWeQ4QDjNygLoDg4QNLcy/uFuJCZ92/7Di*)
(*Ll/pz3iKLc1hiHAw2T40RqQ010SVyd8jIWzFv5C3rl9CvO+KxBcyGFIij6k5*)
(*S4bEs1IiP+bSmJm9kTIiX6e/tNQN85QmW3Jp8lYZ4j6bcdSBj8NE5ZSOSKb0*)
(*y+eR+nfJcsLP7FmGF3XlxP7u1neZHjNXOtrr5Mate+XEvsciOzygRens2dHw*)
(*XSYo0Q+1aylp/CIUKb3Z4NzExCHr0asbzgsxok92XHapwh8j+qfqFsR5nIkh*)
(*K4toAvaab31qufQ8Lx9DrCmrjizW+9593kJeRrnSTR1zBQl8jOj/+d8evrGa*)
(*xhB6n8NAxywGEftX9MzXw5GcB2FO13sw+HmyERX6KD3CjB8/n4ET/+sxZRnJ*)
(*g6v0Wa3zZEMJjvCPnbgfXI1BYm49RXPi//0vlW6eeg==*)
(*"]]}}, AspectRatio -> 1.0764818355640535`, ImagePadding -> {{0., 0.}, {0., 0.}}, ImageSize -> {715., 769.}, PlotRange -> {{-1.0416666666666667`, 1.0416666666666667`}, {-1.04, 1.04}}, PlotRangePadding -> Automatic], Pane[Tree["1034820096\n1140951389", {Tree["2425309256\n2530470398", {Tree["1173998623\n1187632167", {Tree["3283279696\n3296913240", {Tree["1838290849\n1851924393", {Tree["3086555325\n3100188869", {Tree["1733912539\n1747546083", {Tree["867228072\n880861616", None]}]}]}]}]}], Tree["1022591555\n1104980613", {Tree["3131872628\n3214261686", {Tree["1686883781\n1769272839", {Tree["610677275\n621411866", {Tree["142588347\n153322938", {Tree["273426989\n284161580", None]}]}], Tree["1697618373\n1769272839", {Tree["3224592039\n3296246505", {Tree["2590741318\n2662395784", None]}]}]}]}]}], Tree["0\n7830088", {Tree["301964456\n309794544", {Tree["205099681\n212929769", {Tree["781395770\n789225858", {Tree["313306842\n321136930", {Tree["118035224\n125865312", None]}]}]}]}]}], Tree["644900354\n646208806", {Tree["3729900097\n3731208549", {Tree["855656837\n856965289", {Tree["326303688\n327612140", {Tree["444410939\n445719391", {Tree["1814160992\n1815469444", None]}]}]}]}]}]}], Tree["1997427889\n1998398040", {Tree["2466485776\n2467455927", {Tree["2078503930\n2079250992", {Tree["1900200319\n1900947381", {Tree["3148464795\n3149211857", {Tree["1795822009\n1796569071", {Tree["929137542\n929884604", None]}]}]}]}], Tree["4252899518\n4253122607", {Tree["1388291028\n1388514117", {Tree["1545196011\n1545419100", {Tree["3072169677\n3072392766", {Tree["2438318956\n2438542045", None]}]}]}]}]}]}]}, {TreeLayout -> Top}], BoxID -> "ForCanvasToggle", BaselinePosition -> Baseline, ImageSize -> {523, 563}, ImageSizeAction -> "ShrinkToFit"]}, {2, 1}, None, BoxID -> "FromCanvas", Alignment -> {Center, Center}]*)
